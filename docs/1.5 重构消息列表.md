大家好，本节视频。
我们继续重构消息列表。
也就是这个部分。
在 components chat 目录下。
新建 Messages 点 tsx 文件。
存放组件 U。I 相关的代码。
找到 messages 这里 U。I 相关的代码。
复制。
export default 。
将代码粘贴到函数组件中返回。
导入 Bubble 组件。
继续在 models 目录下。
新建 messages 点 tsx 文件。
文件主要职责。
是管理消息列表组件相关的状态、业务逻辑与异步副作用等。

还是导出一个默认的组件函数。
use。X。Chat 是 ant。design。x 。
管理单个对话消息数据的钩子函数。
我们把这里的代码段复制到模型文件中。
返回 messages 对象。
导入 use。x。chat 钩子函数。
从 conversations 引入 c。u。r。conversation 对象。
c。u。r。conversation 就是当前对话的 key 值。
继续引入 locale 对象。
从 index 点 tsx 文件复制 provider。Factory 函数。
provider。caches 这里也要一同复制。
复制过来之后。
导入相关类型。
复制 history。Message。Factory 函数。
导入相关类型。
复制 HISTORY。Messages 。
切换到 Messages。tsx 文件。
从 messages 模型文件。
引入 messages 消息列表对象。

list。ref 我们新建一个 Props 接口。
从父组件通过参数传入。
回到 index。tsx 文件。
我们来看一下 list。ref 的数据类型。
复制 list。ref 的数据类型。
粘贴到 Props 接口定义中。
导入类型。
将 props 类型的参数添加到组件上。
复制 get。role 函数过来。
导入数据类型。
markdown。theme。class 是从 themes 模型中获取的。
复制过来。
styles 与 theme。config 用不到。删掉。
这个 Footer 组件导入错误了。
不应该导入 ant。d 包里面的 Footer。
应该是 index。tsx 文件中自定义的这个 Footer。
复制过来。
导入 React 对象。
导入 Sync 图标。
导入 Actions 对象。



Footer 组件缺少 chat。Context 。
我们给它添加一个参数。
从外部传递进来。
还缺少 locale 本地化对象。
同样从外部传递进来。
locale 对象类型为 Use。Locale。Return。locale。
这里给 Footer 组件添加缺少的属性。
get。Role 函数同样需要加上。chat。Context 与 locale 参数。
Messages。Props 接口中也要添加 chat。Context 与 locale。
locale 对象除了从父组件传递。
还可以从 locales 模型中获取。
还是删掉 Messages。Props 接口中的 locale。
从模型中获取吧。
处理完后，组件基本上没啥问题了。

我们继续处理 messages 模型文件。
把 history。messages 消息列表对象变成一个函数。
因为需要用到 locale 对象。
通过函数参数传入。
最后返回消息列表。

给 history。Message。Factory 函数也加上 locale 参数。
把相关对象与函数。
添加到返回对象上。
这里有几个类型警告。
我们把不能自动识别的类型。
给它使用 as 转换一下。
history。Message。Factory 函数第一个参数为 locale 对象。
这样就没问题了。

接下来，把 index 点 tsx 文件中。
关于 messages 的相关代码删掉。
删掉 History。messages 代码段。
删掉 history。Message。Factory 函数。
删掉 provider。caches 与 provider。factory。
删掉 Footer。
删掉 get。Role。
删掉 use。X。Chat 钩子函数代码段。
把 conversations 模型导入上边。
与其他模型导入放在一起。
然后，从 messages 模型中导入需要的对象。
导入 on。Reload。
Conversations 组件的 messages 属性。
我们给它删掉。
然后在组件内部从 messages 模型导入。
删掉 Props 接口上的 messages 类型定义。
删掉 messages 前面的 props 点。
这一部分直接替换为自定义的 Messages 组件。
组要需要传入 messages 属性。
先从 messages 模型中引入进来。
markdown。theme。class 本页面用不到了。删掉它。
把页面缺失的 messages。isRequesting。on。Request。abort 全都引入一下。
Messages 组件还缺少 list。Ref 与 chat。Context 属性。
给它传递进去。
最后删除掉这些不需要的类型与组件导入。
切换到浏览器预览一下。
